var xfetch=xfetch||{};xfetch.xhrHook=(()=>{var w=Object.defineProperty;var O=Object.getOwnPropertyDescriptor;var S=Object.getOwnPropertyNames;var A=Object.prototype.hasOwnProperty;var _=e=>w(e,"__esModule",{value:!0});var v=(e,t)=>{for(var o in t)w(e,o,{get:t[o],enumerable:!0})},C=(e,t,o,u)=>{if(t&&typeof t=="object"||typeof t=="function")for(let f of S(t))!A.call(e,f)&&(o||f!=="default")&&w(e,f,{get:()=>t[f],enumerable:!(u=O(t,f))||u.enumerable});return e};var k=(e=>(t,o)=>e&&e.get(t)||(o=C(_({}),t,1),e&&e.set(t,o),o))(typeof WeakMap!="undefined"?new WeakMap:0);var z={};v(z,{default:()=>P});var L=e=>{if(/^https?/.test(e))return e;let t=window.location.protocol+"//"+window.location.host;return e[0]==="/"?t+e:t+window.location.pathname+"/"+e},M=e=>[...e.entries()].reduce((t,[o,u])=>(t[o]=u,t),{});var E=(e,t,o=null)=>e.reduce((u,f)=>f.call(o,u),t);function P({namespace:e=globalThis||window}={}){if(e==null&&(e=globalThis||window),typeof e!="object")throw new Error("[xfetch-hook] - `namespace` should be an object");let t=e.XMLHttpRequest;if(typeof t!="function")throw new Error("[xfetch-hook] - `XMLHttpRequest` should be a function.");let o=[];function u(){let r=new t,n=this,d,l,p,b,g,h,x,H,m=[],q=[];this.onreadystatechange=null,r.onreadystatechange=function(){if(p&&this.readyState==4){let s=r.responseType;try{n.response=H||(H=E(m,r.response,n)),(s===""||s==="text")&&(n.responseText=r.responseText),q.forEach(a=>a.call(n,n.response,n))}catch(a){console.warn("Error in proxied xfetch-hook package",a.message)}}if(n.onreadystatechange)return n.onreadystatechange()},["status","statusText","readyState","responseXML","upload"].forEach(function(s){Object.defineProperty(n,s,{get:function(){return r[s]}})}),["ontimeout, timeout","withCredentials","onload","onerror","onprogress","responseType"].forEach(function(s){Object.defineProperty(n,s,{get:function(){return r[s]},set:function(a){s==="onload"&&typeof a=="function"&&(a=a.bind(n)),r[s]=a}})}),["addEventListener","abort","getAllkeyResponseHeaders","getResponseHeader","overrideMimeType"].forEach(function(s){Object.defineProperty(n,s,{value:function(){return r[s].apply(r,arguments)}})});let y=new Headers;n.setRequestHeader=function(a,c){y.append(a,c)},n.open=function(a,c,i,j,U){d=a,l=new URL(L(c)),p=i!==!1,b=j,g=U,r.open(d,l.toString(),p,b,g)},n.send=async function(a){if(h=a,p){for(let c of o){let i=await c({method:d,url:l,body:h,get headers(){return x||(x=M(y))}});!i||(i.method&&(d=i.method),i.url&&(l=i.url.href||i.url),i.body!==void 0&&(h=i.body),i.headers instanceof Headers&&(y=i.headers),typeof i.transformResponse=="function"&&m.push(i.transformResponse),typeof i.listen=="function"&&q.push(i.listen))}r.open(d,l,p,b,g);for(let c in y.entries())r.setRequestHeader(c[0],c[1]);r.send(h)}}}Object.defineProperty(u,"name",{value:"XMLHttpRequest",configurable:!0});function f(){e.XMLHttpRequest=u}f();function R(){e.XMLHttpRequest=t}function T(r){o=o.filter(n=>n!==r)}function X(r){o.push(r)}return u.stopProxying=R,u.onRequest=function(n){if(typeof n!="function")throw new Error("[onRequest] - Argument must be a function");let d=()=>T(n);return o.find(p=>p===n)||X(n),d},R}return k(z);})();
xfetch.xhrHook = xfetch.xhrHook.default;
