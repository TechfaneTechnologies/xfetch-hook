this.xfetch=this.xfetch||{},this.xfetch.xhrMiddleware=function(){"use strict";const e=e=>[...e.entries()].reduce(((e,[t,n])=>(e[t]=n,e)),{});return function({namespace:t=globalThis||window}={}){if(null==t&&(t=globalThis||window),"object"!=typeof t)throw new Error("[xfetch-hook] - `namespace` should be an object");const n=t.XMLHttpRequest;if("function"!=typeof n)throw new Error("[xfetch-hook] - `XMLHttpRequest` should be a function.");const o=[];function r(){let t,r,s,i,a,c,u,f,d=new n,p=this,h=[],l=[];this.onreadystatechange=null,d.onreadystatechange=function(){if(s&&4==this.readyState){let e=d.responseType;try{p.response=f||(f=((e,t)=>e.reduce(((e,t)=>t(e)),t))(h,d.response)),""!==e&&"text"!==e||(p.responseText=d.responseText),l.forEach((e=>e.call(p,p)))}catch(e){console.warn("Error in proxied xfetch-hook package",e.message)}}if(p.onreadystatechange)return p.onreadystatechange()},["status","statusText","readyState","responseXML","upload"].forEach((function(e){Object.defineProperty(p,e,{get:function(){return d[e]}})})),["ontimeout, timeout","withCredentials","onload","onerror","onprogress","responseType"].forEach((function(e){Object.defineProperty(p,e,{get:function(){return d[e]},set:function(t){"onload"===e&&"function"==typeof t&&(t=t.bind(p)),d[e]=t}})})),["addEventListener","abort","getAllkeyResponseHeaders","getResponseHeader","overrideMimeType"].forEach((function(e){Object.defineProperty(p,e,{value:function(){return d[e].apply(d,arguments)}})}));let y=new Headers;p.setRequestHeader=function(e,t){y.append(e,t)},p.open=function(e,n,o,c,u){t=e,r=new URL((e=>{if(/^https?/.test(e))return e;let t=window.location.protocol+"//"+window.location.host;return"/"===e[0]?t+e:t+window.location.pathname+"/"+e})(n)),s=!1!==o,i=c,a=u,d.open(t,r,s,i,a)},p.send=async function(n){if(c=n,s){for(const n of o){let o=await n({method:t,url:r,body:c,get headers(){return u||(u=e(y))}});o&&(o.method&&(t=o.method),o.url&&(r=o.url.href||o.url),void 0!==o.body&&(c=o.body),o.headers instanceof Headers&&(y=o.headers),"function"==typeof o.transformResponse&&h.push(o.transformResponse),"function"==typeof o.listen&&l.push(o.listen))}d.open(t,r,s,i,a);for(const e in y.entries())d.setRequestHeader(e[0],e[1]);d.send(c)}}}function s(){t.XMLHttpRequest=n}return Object.defineProperty(r,"name",{value:"XMLHttpRequest",configurable:!0}),t.XMLHttpRequest=r,r.stopIntercepting=s,r.onRequest=function(e){if("function"!=typeof e)throw new Error("[onRequest] - Argument must be a function");return o.find((t=>t===e))||function(e){o.push(e)}(e),()=>{}},s}}();